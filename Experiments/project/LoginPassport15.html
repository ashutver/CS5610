<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Implementing Security</title>
    <script src="JS/angular.min.js"></script>
    <script src="JS/angular-route.js"></script>
    <script src="JS/angular-route.min.js"></script>
    <script src="JS/project01.js"></script>
    <script src="views/profile/profile.js"></script>
    <script src="views/login/login.js"></script>
    <script src="views/workout/workout.js"></script>
    <script src="views/workoutdetail/workoutdetail.js"></script>
    <script src="views/exercise/exercise.js"></script>
    <script src="views/muscle/muscle.js"></script>
    <script src="views/exercisedetail/exercisedetail.js"></script>
    <script src="views/equipment/equipment.js"></script>
    <script src="views/signup/signup.js"></script>
    <script src="views/nutrition/nutrition.js"></script>
    <script src="views/nutritiondetail/nutritiondetail.js"></script>
    <script src="views/profile/profile.js"></script>
    <script src="views/home/home.js"></script>
    <link href="css/bootstrap.min.css" rel="stylesheet" />
    <script src="JS/jquery.js"></script>
    <script src="JS/jquery-ui.js"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.11.3/themes/smoothness/jquery-ui.css">
    <script src="//angular-ui.github.io/bootstrap/ui-bootstrap-tpls-0.12.1.js"></script>
  
</head>
<body ng-app="PassportApp" style="padding-top:40px">
    <div class="container" >
        <header>
            <h1 class="text-center">Working on Project</h1>
        </header>
        <article>
            <div class="maindiv text-center">
                <div class="div-header"><h3> About the experiment</h3></div>
                <p>
                   In this experiment I have worked on equipment page where user can view all the equipment details. user can select any of the 
                    equipment and related exercises to this equipment will be shown. here i used accordion which open up the data once i click 
                    on any of the heading and respective exercises can be viewed.
                    username: "a", password:"a"
                </p>
                <hr />
            </div>
        </article>
        <nav class="navbar navbar-defalut navbar-fixed-top" ng-controller="navCntrl">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                            data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="#">Fitness Plus</a>
                </div>
                <div class="navbar-collapse collapse" id="bs-example-navbar-collapse-1">
                    <ul class="nav navbar-nav">

                        <li><a href="#/home">Home</a></li>
                        <li ng-show="currentUser"><a href="#/profile">Profile</a></li>
                        <li><a href="#/workout">Workout   </a></li>
                        <li><a href="#/exercise/">Exercises</a></li>
                        <li><a href="#/muscle/">Muscle</a></li>
                        <li><a href="#/equipment/">Equipment</a></li>
                        <li><a href="#/nutrition/">Nutrition</a></li>
                        
                    </ul>
                    <ul class="nav navbar-nav navbar-right">
                        <li ng-show="!currentUser"><a href="#/" ng-click="open()">Login</a></li>
                        <li><a href="#/logout" ng-click="logout()" class="navbar-right">Logout</a></li>
                        <li ng-show="!currentUser"><a href="#/signup">Signup</a></li>
                    </ul>
                </div><!--/.navbar-collapse -->
            </div>
            <script type="text/ng-template" id="content.html">
                <div class="modal-header">
                    <h3 class="modal-title">Login</h3>
                </div>
                <div class="modal-body">
                    <form class="form-horizontal" ng-submit="login(user)" name="myform">
                        <fieldset>
                            <div class="form-group" ng-class="{'has-error': myform.username.$invalid}">
                                <label for="username" class="margin col-lg-3 control-label">UserName&nbsp;&nbsp;*</label>
                                <div class="col-lg-9">
                                    <input type="text" ng-model="user.username" id="username" placeholder="Username"
                                           required class="text form-control margin">
                                </div>
                            </div>
                        
                            <div class="form-group" ng-class="{'has-error': myform.password.$invalid}">
                                <label for="password" class="margin col-lg-3 control-label">Password&nbsp;&nbsp;*</label>
                                <div class="col-lg-9">
                                    <input type="password" ng-model="user.password" id="password" placeholder="xxxxxxx"
                                           required class="text form-control margin">
                                </div>
                            </div>
                            <div class="modal-footer">
                                <div class="col-sm-offset-3 col-sm-8 center-align">
                                    <button type="submit" class="btn btn-lg btn-primary btn-block" ng-disabled="myForm.$invalid">
                                        Login
                                    </button>
                                    <button class="btn btn-lg btn-warning btn-block" ng-click="cancel()">Cancel</button>
                                </div>
                            </div>
                          
                            <!-- Allow form submission with keyboard without duplicating the dialog button
            <input ng-click="signup(user)" type="submit" tabindex="-1" class="btn btn-default margin" value="Register">-->

                        </fieldset>
                    </form>
                </div>
              </script>
        </nav>
        <div ng-view></div>
        <div class="maindiv">
           
            <h4> Code Snippet</h4>
            <hr />
            <pre>
                    Client side  >>
                                     app.config(['$routeProvider', function ($routeProvider) {
                                        $routeProvider.
                                         when('/home', {
                                             templateUrl: 'views/home/home.html'
                                             // controller: 'PhoneListCtrl'
                                         })
                                         .when('/profile', {
                                             templateUrl: 'views/profile/profile.html',
                                             // controller: 'ProfileController',
                                             resolve: {
                                                 loggedin :checkLoggedin
                                             }
                                         })
                                         .when('/login', {
                                             templateUrl: 'views/login/login.html',
                                              controller: 'LoginCtrl'
                                         })
                               }]);

                var checkLoggedin = function ($q, $timeout, $http, $location, $rootScope) {
                    var deferred = $q.defer();
                    $http.get('/api/loggedin').success(function (user) {
                        $rootScope.errorMessage = null;
                        //user is Authenticated
                        console.log(user);
                        if (user != '0') {
                            $rootScope.currentUser = user;
                            deferred.resolve();
                        } else {
                            $rootScope.errorMessage = "you need to login";
                            deferred.reject();
                            $location.url("/login");
                        }
                    });
                }
                    Server Side >>
                                      passport.use(new LocalStrategy(
                                            function (username, password, done) {
                                                 UserModel.findOne({ username: username, password: password }, function (err,user) {
                                                    if (user) {
                                                        return done(null, user);
                                                    }
                                                    return done(null, false);
                                                });
        
                                            }));
                                        passport.serializeUser(function (user, done) {
                                            done(null, user);
                                        });
                                        passport.deserializeUser(function (user, done) {
                                            done(null, user);
                                        });
                                        app.post("/api/login", passport.authenticate('local'),
                                            function (req, res) { // once user is authenticated by passport it puts the user object in req 
                                                var user = req.user;
                                                res.json(user);
                                            });

                 
                    
        </pre>
        </div>
        <hr />
        <div class="maindiv">
            <h4> Code Snippet Explanation</h4>
            <hr />
            <p>
                I have worked on equipment page where user can view all the equipment details. user can select any of the
                equipment and related exercises to this equipment will be shown. here i used accordion which open up the data once i click
                on any of the heading and respective exercises can be viewed.
            </p>
            <hr />
            <h4> Source Code</h4>
            <a href="http://net4.ccs.neu.edu/home/ashutver/fileview/Default.aspx?~/Experiments/ProjExp/LoginPassport15.html" target="_blank">HTML Source</a>
            <a href="http://net4.ccs.neu.edu/home/ashutver/fileview/Default.aspx?~/Experiments/ProjExp/JS/project01.js" target="_blank">JS Source</a>
            <a href="http://net4.ccs.neu.edu/home/ashutver/fileview/Default.aspx?~/Experiments/NodeJs/server.js" target="_blank">Server Source</a>
            <hr />
            <h4>Refrences</h4>
            <a href="https://nodejs.org/" target="_blank">Node</a>

            <hr />
        </div>

       

    </div>
</body>
</html>